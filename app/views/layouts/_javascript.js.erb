/* Volunteer new edit upload */
/* http://pastie.org/212866 */
(function($) {
    $.ajaxSetup({
	beforeSend: function(xhr) {
	    xhr.setRequestHeader("Accept", "text/javascript, text/html, application/xml, text/xml, */*");
	    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
	}
    });

    $().ajaxSend(function(event, request, settings) {
	if (typeof(AUTH_TOKEN) == "undefined") return;
	settings.data = settings.data || "";
	settings.data += ((settings.data == "") ? "" : "&") + "authenticity_token=" + encodeURIComponent(AUTH_TOKEN);
    });
})(jQuery);

/* Volunteer new edit upload */
/* pre-submit callback */
function showRequest(formData, jqForm, options) {
    var queryString = $.param(formData);
    // alert('About to submit: \n\n' + queryString);
    return true;
}

<% @cheese ||= [] -%>
<% @images ||= [] -%>
var vImages=new Array("<%=raw @images.join("\", \"") %>");
var cheeseImages=new Array("<%=raw @cheese.join("\", \"") %>");
var curImage=0;

/* Volunteer new edit upload */
/* post-submit callback */
function showResponse(responseText, statusText)  {
/*  alert('status: ' + statusText + '\n\nresponseText: \n' + responseText +
        '\n\nThe output div should have already been updated with the responseT\
ext.');
*/
}

/* For upload form */
var form_options = {
    iframe:        true,         // Handle multipart data
    target:        '#image_selector',  // target element(s) to be updated
    beforeSubmit:  showRequest,  // pre-submit callback
    success:       showResponse  // post-submit callback
};
